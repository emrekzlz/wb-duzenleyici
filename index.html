<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WB Profesyonel Ba≈ülƒ±k D√ºzenleyici v2 (Tam Temizlik)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); padding: 40px; }
        h1 { color: #1a202c; text-align: center; margin-bottom: 10px; font-size: 2.2em; }
        .subtitle { text-align: center; color: #718096; margin-bottom: 30px; font-size: 1.1em; }
        .upload-area { border: 3px dashed #cbd5e0; border-radius: 15px; padding: 50px; text-align: center; background: #f7fafc; cursor: pointer; transition: 0.3s; }
        .upload-area:hover { border-color: #2a5298; background: #ebf8ff; }
        .rules-box { background: #fff5f5; border-left: 4px solid #fc8181; padding: 20px; margin: 30px 0; border-radius: 8px; }
        .rules-title { font-weight: bold; color: #c53030; margin-bottom: 10px; }
        .rules-list { font-size: 0.9em; color: #742a2a; margin-left: 20px; }
        .btn { display: inline-block; background: #2a5298; color: white; padding: 15px 40px; border-radius: 8px; text-decoration: none; font-weight: bold; cursor: pointer; border: none; margin-top: 20px; }
        .btn:hover { background: #1e3c72; }
        .preview-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.9em; }
        .preview-table th { background: #2d3748; color: white; padding: 12px; text-align: left; }
        .preview-table td { border-bottom: 1px solid #e2e8f0; padding: 10px; }
        #progressContainer { display: none; margin: 20px 0; }
        .progress-bar { width: 100%; height: 20px; background: #edf2f7; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: #48bb78; width: 0%; transition: width 0.3s; }
        #resultArea { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ WB Profesyonel Ba≈ülƒ±k D√ºzenleyici v2</h1>
        <p class="subtitle">Sarkan Kelimeler ve Baƒüla√ßlar Temizlendi</p>

        <div class="upload-area" id="uploadArea">
            <div style="font-size: 3em; margin-bottom: 15px;">üìÇ</div>
            <div>Dosyayƒ± S√ºr√ºkle veya Tƒ±kla (.xlsx)</div>
            <input type="file" id="fileInput" accept=".xlsx,.xls">
        </div>

        <div class="rules-box">
            <div class="rules-title">‚ú® v2 G√ºncellemeleri:</div>
            <ul class="rules-list">
                <li><b>1. Yarƒ±m Kalan ƒ∞fadeler Yok:</b> "V-–æ–±—Ä–∞–∑–Ω—ã–º" (V ≈üeklinde), "–∫–æ—Ä–æ—Ç–∫–∏–º" (kƒ±sa) gibi kelimeler nounsƒ±z kalƒ±rsa silinir.</li>
                <li><b>2. Baƒüla√ß Temizliƒüi:</b> "—Å" (ile), "–∏" (ve), "–∏–∑" (den) gibi kelimeler tek ba≈üƒ±na kalƒ±rsa temizlenir.</li>
                <li><b>3. Kuma≈ü Detaylarƒ±:</b> Jersey, Ka≈ükorse, Viskon gibi kuma≈ü isimleri ba≈ülƒ±ktan u√ßurulur.</li>
                <li><b>4. Y√∂netici Formatƒ±:</b> [√úr√ºn] + [Hedef Kitle] + [Temiz Detay] sƒ±ralamasƒ± korunur.</li>
            </ul>
        </div>

        <div id="progressContainer">
            <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
            <div style="text-align: center; margin-top: 5px;" id="progressText">0%</div>
        </div>

        <div id="resultArea">
            <div style="text-align: center;">
                <button class="btn" id="downloadBtn">üì• D√ºzenlenmi≈ü Dosyayƒ± ƒ∞ndir</button>
            </div>
            <div id="previewContainer"></div>
        </div>
    </div>

    <script>
        class WBManagerCleaner {
            constructor() {
                // 1. √úr√ºn ƒ∞simleri (√ñne √ßekilecek ve tekil yapƒ±lacaklar)
                this.urunSozlugu = {
                    '—Ñ—É—Ç–±–æ–ª–∫–∏': '–§—É—Ç–±–æ–ª–∫–∞', '—Ñ—É—Ç–±–æ–ª–∫–∞': '–§—É—Ç–±–æ–ª–∫–∞',
                    '—Ä—É–±–∞—à–∫–∏': '–†—É–±–∞—à–∫–∞', '—Ä—É–±–∞—à–∫–∞': '–†—É–±–∞—à–∫–∞',
                    '–±–ª—É–∑–∫–∏': '–ë–ª—É–∑–∫–∞', '–±–ª—É–∑–∫–∞': '–ë–ª—É–∑–∫–∞',
                    '–ø–ª–∞—Ç—å—è': '–ü–ª–∞—Ç—å–µ', '–ø–ª–∞—Ç—å–µ': '–ü–ª–∞—Ç—å–µ',
                    '–∫–æ—Å—Ç—é–º—ã': '–ö–æ—Å—Ç—é–º', '–∫–æ—Å—Ç—é–º': '–ö–æ—Å—Ç—é–º',
                    '—Å–≤–∏—Ç–µ—Ä–∞': '–°–≤–∏—Ç–µ—Ä', '—Å–≤–∏—Ç–µ—Ä': '–°–≤–∏—Ç–µ—Ä',
                    '–¥–∂–µ–º–ø–µ—Ä—ã': '–î–∂–µ–º–ø–µ—Ä', '–¥–∂–µ–º–ø–µ—Ä': '–î–∂–µ–º–ø–µ—Ä',
                    '—Ç–æ–ª—Å—Ç–æ–≤–∫–∏': '–¢–æ–ª—Å—Ç–æ–≤–∫–∞', '—Ç–æ–ª—Å—Ç–æ–≤–∫–∞': '–¢–æ–ª—Å—Ç–æ–≤–∫–∞',
                    '—Å–≤–∏—Ç—à–æ—Ç—ã': '–°–≤–∏—Ç—à–æ—Ç', '—Å–≤–∏—Ç—à–æ—Ç': '–°–≤–∏—Ç—à–æ—Ç',
                    '–º–∞–π–∫–∏': '–ú–∞–π–∫–∞', '–º–∞–π–∫–∞': '–ú–∞–π–∫–∞',
                    '—Ç–æ–ø—ã': '–¢–æ–ø', '—Ç–æ–ø': '–¢–æ–ø',
                    '–ø–∏–∂–∞–º—ã': '–ü–∏–∂–∞–º–∞', '–ø–∏–∂–∞–º–∞': '–ü–∏–∂–∞–º–∞',
                    '—Ö–∞–ª–∞—Ç—ã': '–•–∞–ª–∞—Ç', '—Ö–∞–ª–∞—Ç': '–•–∞–ª–∞—Ç',
                    '–∫—É—Ä—Ç–∫–∏': '–ö—É—Ä—Ç–∫–∞', '–∫—É—Ä—Ç–∫–∞': '–ö—É—Ä—Ç–∫–∞',
                    '–∂–∏–ª–µ—Ç—ã': '–ñ–∏–ª–µ—Ç', '–∂–∏–ª–µ—Ç': '–ñ–∏–ª–µ—Ç',
                    '–∫–æ–º–±–∏–Ω–µ–∑–æ–Ω—ã': '–ö–æ–º–±–∏–Ω–µ–∑–æ–Ω', '–∫–æ–º–±–∏–Ω–µ–∑–æ–Ω': '–ö–æ–º–±–∏–Ω–µ–∑–æ–Ω',
                    '–∫–∞—Ä–¥–∏–≥–∞–Ω—ã': '–ö–∞—Ä–¥–∏–≥–∞–Ω', '–∫–∞—Ä–¥–∏–≥–∞–Ω': '–ö–∞—Ä–¥–∏–≥–∞–Ω',
                    '–±–æ–¥–∏': '–ë–æ–¥–∏',
                    '—Ç—É–Ω–∏–∫–∏': '–¢—É–Ω–∏–∫–∞', '—Ç—É–Ω–∏–∫–∞': '–¢—É–Ω–∏–∫–∞',
                    '–ø–∞–ª—å—Ç–æ': '–ü–∞–ª—å—Ç–æ',
                    '–±—Ä—é–∫–∏': '–ë—Ä—é–∫–∏', '—à–æ—Ä—Ç—ã': '–®–æ—Ä—Ç—ã', '–¥–∂–∏–Ω—Å—ã': '–î–∂–∏–Ω—Å—ã', 
                    '–ª–µ–≥–≥–∏–Ω—Å—ã': '–õ–µ–≥–≥–∏–Ω—Å—ã', '–ª–æ—Å–∏–Ω—ã': '–õ–æ—Å–∏–Ω—ã', '—Ç—Ä—É—Å—ã': '–¢—Ä—É—Å—ã',
                    '–∫–æ–º–ø–ª–µ–∫—Ç—ã': '–ö–æ–º–ø–ª–µ–∫—Ç', '–∫–æ–º–ø–ª–µ–∫—Ç': '–ö–æ–º–ø–ª–µ–∫—Ç'
                };

                // 2. G√º√ßlendirilmi≈ü Silme Listesi (Regex)
                // (?:—Å|—Å–æ|–∏|–∏–∑)? -> Ba≈üƒ±ndaki 'ile', 've', 'den' baƒüla√ßlarƒ±nƒ± opsiyonel olarak yakalar
                this.yasakliKelimeler = [
                    // Yaka Tipleri (Baƒüla√ßlarƒ±yla birlikte)
                    /(?:—Å|—Å–æ|–∏)?\s*v[\s-]*–æ–±—Ä–∞–∑–Ω[–∞-—è]*\s*(?:–≤—ã—Ä–µ–∑[–∞-—è]*)?/gi, // V-–æ–±—Ä–∞–∑–Ω—ã–º (–≤—ã—Ä–µ–∑ olsun olmasƒ±n sil)
                    /(?:—Å|—Å–æ|–∏)?\s*–∫—Ä—É–≥–ª[–∞-—è]*\s*–≤—ã—Ä–µ–∑[–∞-—è]*/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–≤—ã—Ä–µ–∑[–∞-—è]*\s*–ª–æ–¥–æ—á–∫[–∞-—è]*/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–∫–≤–∞–¥—Ä–∞—Ç–Ω[–∞-—è]*\s*–≤–æ—Ä–æ—Ç–Ω–∏–∫[–∞-—è]*/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–æ—Ç–ª–æ–∂–Ω[–∞-—è]*\s*–≤–æ—Ä–æ—Ç–Ω–∏–∫[–∞-—è]*/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–≤–æ—Ä–æ—Ç–Ω–∏–∫[–∞-—è]*\s*—Å—Ç–æ–π–∫[–∞-—è]*/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–≤–æ—Ä–æ—Ç–Ω–∏–∫[–∞-—è]*/gi, // Tek ba≈üƒ±na 'yaka' kelimesi
                    /(?:—Å|—Å–æ|–∏)?\s*–≤—ã—Ä–µ–∑[–∞-—è]*/gi, // Tek ba≈üƒ±na 'kesim/dekolte' kelimesi

                    // Kol Tipleri (Baƒüla√ßlarƒ±yla birlikte)
                    /(?:—Å|—Å–æ|–∏)?\s*(?:–∫–æ—Ä–æ—Ç–∫[–∞-—è]*|–¥–ª–∏–Ω–Ω[–∞-—è]*)\s*—Ä—É–∫–∞–≤[–∞-—è]*/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–±–µ–∑\s*—Ä—É–∫–∞–≤–æ–≤/gi,

                    // Kesim ve Kalƒ±p
                    /(?:—Å|—Å–æ|–∏)?\s*—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω[–∞-—è]*\s*–∫—Ä–æ[—è–π]/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*—Å–≤–æ–±–æ–¥–Ω[–∞-—è]*\s*–∫—Ä–æ[—è–π]/gi,
                    /(?:—Å|—Å–æ|–∏)?\s*–ø—Ä–∏—Ç–∞–ª–µ–Ω–Ω[–∞-—è]*/gi,
                    /–æ–≤–µ—Ä—Å–∞–π–∑/gi,
                    /slim\s*fit/gi, /regular\s*fit/gi,

                    // Kuma≈ülar (iz ... yapƒ±sƒ±)
                    /–∏–∑\s*—Ö–ª–æ–ø–∫[–∞-—è]*/gi, /–∏–∑\s*—Ç—Ä–∏–∫–æ—Ç–∞–∂[–∞-—è]*/gi, /–∏–∑\s*–≤–∏—Å–∫–æ–∑[–∞-—è]*/gi,
                    /–∏–∑\s*–¥–∂–µ—Ä—Å–∏/gi, /–∏–∑\s*–∫–∞—à–∫–æ—Ä—Å–µ/gi, /–∏–∑\s*–ª–µ–Ω/gi, /–∏–∑\s*–ª—å–Ω–∞/gi,
                    /—Ö–ª–æ–ø–∫–æ–≤[–∞-—è]*/gi, /—Ç—Ä–∏–∫–æ—Ç–∞–∂–Ω[–∞-—è]*/gi,

                    // Adet ve Paket Bilgileri
                    /(\d+)\s*(—à—Ç|—É–ø–∞–∫–æ–≤[–∞-—è]*|–ø–∞—Ä[–∞-—è]*|–Ω–∞–±–æ—Ä[–∞-—è]*|pack|pcs)/gi,
                    /–∫–æ–º–ø–ª–µ–∫—Ç\s*–∏–∑\s*\d+.*/gi, 
                    /\s\d+\s*$/ // Sondaki tek rakamlar
                ];

                // 3. Hedef Kitle
                this.hedefKitle = [
                    { p: /–∂–µ–Ω—â–∏–Ω[–∞—ã]/gi, r: '–¥–ª—è –∂–µ–Ω—â–∏–Ω' },
                    { p: /–º—É–∂—á–∏–Ω[–∞—ã]/gi, r: '–¥–ª—è –º—É–∂—á–∏–Ω' },
                    { p: /–¥–µ–≤–æ—á[–∞-—è]*/gi, r: '–¥–ª—è –¥–µ–≤–æ—á–µ–∫' },
                    { p: /–º–∞–ª—å—á–∏[–∞-—è]*/gi, r: '–¥–ª—è –º–∞–ª—å—á–∏–∫–æ–≤' },
                    { p: /–∂–µ–Ω—Å–∫[–∞-—è]*/gi, r: '–¥–ª—è –∂–µ–Ω—â–∏–Ω' },
                    { p: /–º—É–∂—Å–∫[–∞-—è]*/gi, r: '–¥–ª—è –º—É–∂—á–∏–Ω' },
                    { p: /–¥–µ—Ç—Å–∫[–∞-—è]*/gi, r: '–¥–ª—è –¥–µ—Ç–µ–π' },
                    { p: /–º–∞–ª—ã—à[–∞-—è]*/gi, r: '–¥–ª—è –º–∞–ª—ã—à–µ–π' }
                ];
            }

            // Sarkan Baƒüla√ßlarƒ± Temizleme (S√ºp√ºrge)
            baglacTemizle(metin) {
                let kelimeler = metin.split(/\s+/);
                // Tek ba≈üƒ±na kalan anlamsƒ±z kƒ±sa kelimeler (Rus√ßa baƒüla√ßlar)
                const copBaglaclar = ['—Å', '—Å–æ', '–∏', '–∏–∑', '–Ω–∞', '–≤', '–ø–æ', '–¥–ª—è']; 
                
                // Eƒüer kelime bu listedeyse ve (c√ºmlenin sonundaysa VEYA bir sonraki kelime de baƒüla√ßsa) sil
                let temizKelimeler = [];
                for (let i = 0; i < kelimeler.length; i++) {
                    let k = kelimeler[i].toLowerCase();
                    let sonraki = kelimeler[i+1] ? kelimeler[i+1].toLowerCase() : null;

                    // Eƒüer baƒüla√ßsa
                    if (copBaglaclar.includes(k)) {
                        // Eƒüer sonda ise ekleme (sil)
                        if (!sonraki) continue;
                        // Eƒüer hedef kitle √∂ncesi "–¥–ª—è" ise KORU (√∂rn: –¥–ª—è –∂–µ–Ω—â–∏–Ω)
                        if (k === '–¥–ª—è' && (sonraki.includes('–∂–µ–Ω') || sonraki.includes('–º—É–∂') || sonraki.includes('–¥–µ–≤') || sonraki.includes('–º–∞–ª'))) {
                            temizKelimeler.push(kelimeler[i]);
                            continue;
                        }
                        // Diƒüer durumlarda tek ba≈üƒ±na kaldƒ±ysa sil (genelde silinir)
                        continue; 
                    }
                    temizKelimeler.push(kelimeler[i]);
                }
                return temizKelimeler.join(' ');
            }

            temizleVeDuzenle(baslik) {
                if (!baslik) return "";
                let orjinal = String(baslik);
                let islenen = orjinal;

                // A. Noktalama Temizliƒüi
                islenen = islenen.replace(/[:;,\.\-\/\+\(\)]/g, " ");

                // B. Yasaklƒ± Kelime Temizliƒüi (Regex ile)
                this.yasakliKelimeler.forEach(regex => {
                    islenen = islenen.replace(regex, " ");
                });

                // C. Sarkan Baƒüla√ß Temizliƒüi (Manuel S√ºp√ºrme)
                islenen = this.baglacTemizle(islenen);

                // D. Kelimeleri Analiz Et (√úr√ºn Bulma)
                let kelimeler = islenen.split(/\s+/).filter(k => k.length > 0);
                let anaUrun = "";
                let hedefKitleStr = "";
                let digerKelimeler = [];

                kelimeler.forEach(kelime => {
                    let kucuk = kelime.toLowerCase();
                    
                    // Hedef Kitle mi?
                    let kitleBulundu = false;
                    for (let hk of this.hedefKitle) {
                        if (hk.p.test(kelime)) {
                            hedefKitleStr = hk.r;
                            kitleBulundu = true;
                            break;
                        }
                    }
                    if (kitleBulundu) return;

                    // Ana √úr√ºn m√º?
                    // Stemming benzeri kontrol (Basit√ße kelime k√∂k√ºne bakƒ±yoruz)
                    let safKelime = kucuk.replace(/[–∞–∏—ã–µ]$/, ""); // Basit Rus√ßa k√∂k bulma
                    let eslesme = Object.keys(this.urunSozlugu).find(k => k.startsWith(safKelime));
                    
                    if (eslesme && !anaUrun) {
                        anaUrun = this.urunSozlugu[eslesme];
                        return;
                    }
                    // Eƒüer tam e≈üle≈üme varsa
                    if (this.urunSozlugu[kucuk]) {
                        if (!anaUrun) {
                            anaUrun = this.urunSozlugu[kucuk];
                            return;
                        }
                    }

                    // Rakam deƒüilse ve tek harf deƒüilse ekle
                    if (!/^\d+$/.test(kelime) && kelime.length > 1) {
                        digerKelimeler.push(kelime);
                    }
                });

                // E. Ba≈ülƒ±ƒüƒ± Olu≈ütur
                let yeniBaslikParcalari = [];

                // 1. √úr√ºn
                if (anaUrun) {
                    yeniBaslikParcalari.push(anaUrun);
                } else if (digerKelimeler.length > 0) {
                    // √úr√ºn bulamadƒ±ysak en anlamlƒ± kelimeyi ba≈üa al (genelde ilki)
                    let ilk = digerKelimeler.shift();
                    ilk = ilk[0].toUpperCase() + ilk.slice(1).toLowerCase();
                    yeniBaslikParcalari.push(ilk);
                }

                // 2. Hedef Kitle
                if (hedefKitleStr) {
                    yeniBaslikParcalari.push(hedefKitleStr);
                }

                // 3. Diƒüer Detaylar
                digerKelimeler.forEach(k => {
                    // Eƒüer kelime yasaklƒ± listesinden ka√ßmƒ±≈ü bir baƒüla√ßsa yine ekleme
                    if (['—Å', '–∏', '–∏–∑'].includes(k.toLowerCase())) return;
                    
                    if (k === k.toUpperCase()) yeniBaslikParcalari.push(k);
                    else yeniBaslikParcalari.push(k.toLowerCase());
                });

                let sonuc = yeniBaslikParcalari.join(" ").trim();

                // F. Son Kontrol
                sonuc = sonuc.replace(/\s+/g, " ");
                if (sonuc.length > 60) {
                    sonuc = sonuc.substring(0, 60).trim();
                }

                return sonuc;
            }
        }

        // --- UI Kƒ±smƒ± ---
        const cleaner = new WBManagerCleaner();
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        
        uploadArea.onclick = () => fileInput.click();
        
        uploadArea.ondragover = (e) => { e.preventDefault(); uploadArea.style.borderColor = '#48bb78'; };
        uploadArea.ondragleave = () => { uploadArea.style.borderColor = '#cbd5e0'; };
        uploadArea.ondrop = (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#cbd5e0';
            if(e.dataTransfer.files[0]) processFile(e.dataTransfer.files[0]);
        };

        fileInput.onchange = (e) => { if(e.target.files[0]) processFile(e.target.files[0]); };

        let resultWorkbook = null;

        function processFile(file) {
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('resultArea').style.display = 'none';
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet, {header: 1});

                const headers = json[0];
                // Yeni s√ºtun ismi
                const outputData = [ [...headers, "WB_Manager_Cleaned"] ];
                
                let nameIndex = headers.findIndex(h => h && /name|isim|–Ω–∞–∑–≤–∞–Ω–∏–µ/i.test(h));
                if (nameIndex === -1) nameIndex = 0;

                let totalRows = json.length;

                for(let i=1; i < totalRows; i++) {
                    const row = json[i];
                    const rawTitle = row[nameIndex];
                    const cleanTitle = cleaner.temizleVeDuzenle(rawTitle);
                    
                    const newRow = [...row];
                    newRow.push(cleanTitle);
                    outputData.push(newRow);

                    if (i % 50 === 0) {
                        let pct = Math.round((i / totalRows) * 100);
                        document.getElementById('progressFill').style.width = pct + "%";
                        document.getElementById('progressText').innerText = pct + "%";
                    }
                }

                document.getElementById('progressFill').style.width = "100%";
                document.getElementById('progressText').innerText = "100%";

                const newSheet = XLSX.utils.aoa_to_sheet(outputData);
                resultWorkbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(resultWorkbook, newSheet, "WB_Cleaned");

                showPreview(outputData);
                document.getElementById('resultArea').style.display = 'block';
            };
            reader.readAsArrayBuffer(file);
        }

        function showPreview(data) {
            let html = '<table class="preview-table"><thead><tr><th>Orjinal</th><th>WB Temizlenmi≈ü (v2)</th></tr></thead><tbody>';
            let nameIdx = data[0].findIndex(h => h && /name|isim|–Ω–∞–∑–≤–∞–Ω–∏–µ/i.test(h));
            if(nameIdx === -1) nameIdx = 0;

            for(let i=1; i < Math.min(data.length, 11); i++) {
                html += `<tr><td>${data[i][nameIdx] || ''}</td><td style="color:#2a5298; font-weight:bold;">${data[i][data[i].length-1]}</td></tr>`;
            }
            html += '</tbody></table>';
            document.getElementById('previewContainer').innerHTML = html;
        }

        document.getElementById('downloadBtn').onclick = () => {
            if(resultWorkbook) XLSX.writeFile(resultWorkbook, "WB_Temiz_Basliklar_v2.xlsx");
        };
    </script>
</body>
</html>
